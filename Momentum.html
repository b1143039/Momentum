<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  :root { 
    --bg: #ffffff; --text: #222; --border: #ddd; 
    --brand: #6ee7ff; /* 水藍色 */
    --danger: #f87171; /* 珊瑚紅 */
    --accent: #007bff; 
  }
  body { margin: 0; font-family: "Microsoft JhengHei", sans-serif; background: var(--bg); color: var(--text); display: flex; justify-content: center; }
  .container { width: 100%; max-width: 1000px; padding: 20px; }
  
  /* 模擬器區塊 - 大字體化 */
  .sim-card { border: 2px solid var(--border); border-radius: 16px; padding: 25px; background: #fff; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
  .kpi-row { display: flex; justify-content: space-around; margin-bottom: 20px; font-weight: 800; font-size: 24px; color: var(--accent); }
  canvas { width: 100%; height: 220px; background: #fff; border-bottom: 2px solid #eee; margin-bottom: 20px; }
  .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; background: #fcfcfc; padding: 25px; border-radius: 12px; border: 1px solid #eee; }
  .btn-group { text-align: center; margin-top: 25px; }
  button.action { padding: 15px 30px; cursor: pointer; border-radius: 10px; border: 1px solid #ccc; background: white; font-size: 22px; font-weight: bold; transition: 0.2s; }
  button.primary { background: var(--accent); color: white; border: none; }

  /* 你的原本 Tab 樣式 - 字體加大 */
  .tab-list { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 15px; }
  .tab { padding: 12px 18px; border: 1px solid var(--border); background: #fff; cursor: pointer; border-radius: 8px; font-size: 18px; font-weight: bold; }
  .tab[aria-selected="true"] { background: var(--accent); color: white; border-color: var(--accent); }
  
  .tab-panel { display: none; padding: 30px; border: 1px solid var(--border); border-radius: 12px; line-height: 1.8; font-size: 20px; background: #fff; }
  .tab-panel.active { display: block; animation: fadeIn 0.3s; }
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

  .formula-block { background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 15px 0; text-align: center; border: 1px dashed #ccc; font-size: 22px; }
  label { font-size: 20px; font-weight: bold; }
  input[type=range] { height: 25px; cursor: pointer; }
</style>
<script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>

<div class="container">
  <h1 style="text-align:center; font-size:32px;">Momentum, Impulse, and Collisions</h1>

  <div class="sim-card">
    <div class="kpi-row">
      <div>目前總動量 (P): <span id="pNow">0</span> kg·m/s</div>
    </div>
    <canvas id="simCanvas"></canvas>
    <div class="controls">
      <div>
        <label>球 1 質量 (m₁): <span id="m1v">2.0</span> kg</label>
        <input id="m1" type="range" min="1" max="5" step="0.1" value="2.0" style="width:100%">
      </div>
      <div>
        <label>球 2 質量 (m₂): <span id="m2v">2.0</span> kg</label>
        <input id="m2" type="range" min="1" max="5" step="0.1" value="2.0" style="width:100%">
      </div>
    </div>
    <div class="btn-group">
      <button id="startBtn" class="action primary">▶ 開始模擬</button>
      <button id="resetBtn" class="action">↺ 重設</button>
    </div>
  </div>

  <section class="card tabs" aria-label="學習分頁">
    <div class="tab-list" role="tablist">
      <button role="tab" class="tab" aria-selected="true" onclick="openTab(event, 'panel-law')">定律內容</button>
      <button role="tab" class="tab" aria-selected="false" onclick="openTab(event, 'panel-formula')">公式表示</button>
      <button role="tab" class="tab" aria-selected="false" onclick="openTab(event, 'panel-diagram')">圖像理解</button>
      <button role="tab" class="tab" aria-selected="false" onclick="openTab(event, 'panel-scope')">適用範圍</button>
      <button role="tab" class="tab" aria-selected="false" onclick="openTab(event, 'panel-apps')">常見應用</button>
      <button role="tab" class="tab" aria-selected="false" onclick="openTab(event, 'panel-quiz')">教學延伸問題</button>
      <button role="tab" class="tab" aria-selected="false" onclick="openTab(event, 'panel-ans')">延伸問題解答</button>
    </div>

    <div id="panel-law" class="tab-panel active">
      <ul>
        <li><b>動量（Momentum）</b>：\( \vec p=m\vec v \)，方向同速度。</li>
        <li><b>衝量（Impulse）</b>：\( \vec J=\int \vec F\,dt=\Delta\vec p \)。</li>
        <li><b>動量守恆</b>：孤立系統（外力合≈0）總動量不變。</li>
        <li><b>碰撞型態</b>：彈性（動量/動能守恆）、完全非彈性（碰後同速，僅動量守恆）、一般非彈性（恢復係數 \(e\) 介於 0–1）。</li>
      </ul>
    </div>

    <div id="panel-formula" class="tab-panel">
      <div class="formula-block">動量：\( \displaystyle \vec p = m\vec v \)</div>
      <div class="formula-block">衝量：\( \displaystyle \vec J = \int \vec F\, dt = \Delta \vec p \)</div>
      <div class="formula-block">動量守恆：\( \displaystyle \sum \vec p_i = \sum \vec p_f \)</div>
      <div class="formula-block">彈性碰撞（1D）：\( \displaystyle v_1'=\frac{(m_1-m_2)v_1+2m_2v_2}{m_1+m_2}, \; v_2'=\frac{(m_2-m_1)v_2+2m_1v_1}{m_1+m_2} \)</div>
      <div class="formula-block">一般非彈性（1D，恢復係數 \(e\)）：\( \displaystyle v_1'=\frac{m_1v_1+m_2v_2-m_2 e (v_1-v_2)}{m_1+m_2},\; v_2'=\frac{m_1v_1+m_2v_2+m_1 e (v_1-v_2)}{m_1+m_2} \)</div>
    </div>

    <div id="panel-diagram" class="tab-panel">
      <figure style="text-align:center; margin: 6px 0 10px">
        <svg width="620" height="120" viewBox="0 0 620 120" role="img" aria-label="一維碰撞示意圖">
          <defs>
            <marker id="arrowBlue" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto">
              <path d="M0 0 L10 5 L0 10 Z" fill="#6ee7ff"></path>
            </marker>
            <marker id="arrowRed" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto">
              <path d="M0 0 L10 5 L0 10 Z" fill="#f87171"></path>
            </marker>
          </defs>
          <line x1="20" y1="60" x2="600" y2="60" stroke="#ccc" stroke-width="2"/>
          <circle cx="170" cy="60" r="20" fill="#6ee7ff"/>
          <text x="170" y="56" text-anchor="middle" font-size="12" fill="#333">m₁</text>
          <line x1="210" y1="60" x2="290" y2="60" stroke="#6ee7ff" stroke-width="3" marker-end="url(#arrowBlue)"/>
          <text x="250" y="50" font-size="12" fill="#6ee7ff">v₁ > 0</text>
          <circle cx="450" cy="60" r="20" fill="#f87171"/>
          <text x="450" y="56" text-anchor="middle" font-size="12" fill="#333">m₂</text>
          <line x1="410" y1="60" x2="330" y2="60" stroke="#f87171" stroke-width="3" marker-end="url(#arrowRed)"/>
          <text x="370" y="50" font-size="12" fill="#f87171">v₂ < 0</text>
        </svg>
        <figcaption style="font-size:16px; color:#666;">短暫接觸力會重新分配動量；若外力可忽略，系統總動量不變。</figcaption>
      </figure>
    </div>

    <div id="panel-scope" class="tab-panel">
      <ul>
        <li>碰撞時間短、內力遠大於外力。</li>
        <li>入門用一維；多維需分解法向/切向分量。</li>
        <li>巨觀低速情境；高速需相對論動量修正。</li>
      </ul>
    </div>

    <div id="panel-apps" class="tab-panel">
      <ul>
        <li>交通事故重建與後座力估算。</li>
        <li>運動科學：棒球打擊、撞球反彈、足球射門。</li>
        <li>安全裝置：氣囊/緩衝材把作用時間拉長，降低力峰值。</li>
      </ul>
    </div>

    <div id="panel-quiz" class="tab-panel">
      <ol>
        <li>2 kg 球以 3 m/s 向右，0.2 s 內被停下：求衝量與平均力。</li>
        <li>1 kg 小車以 4 m/s 撞上 3 kg 靜止小車並黏住：合體速度與動能變化？</li>
        <li>\(m_1=1\) kg、\(m_2=2\) kg、\(v_1=5\) m/s、\(v_2=0\)：彈性碰撞後 \(v_1',v_2'\)？</li>
        <li>同向一般非彈性，\(v_1=6\) m/s、\(v_2=2\) m/s、\(e=0.6\) ：解 \(v_1',v_2'\)。</li>
        <li>質點 \(\vec v=(3,-4)\) m/s 撞水平牆（彈性反射）：\(\vec v'\)？</li>
      </ol>
    </div>

    <div id="panel-ans" class="tab-panel">
      <details open><summary><b>題 1</b></summary>\(p=2\times3=6\) kg·m/s 向右；\(\Delta p=-6\)（向左）。\(J=\Delta p=-6\) kg·m/s；\(\bar F=J/\Delta t=-6/0.2=-30\) N（向左）。</details>
      <details><summary><b>題 2</b></summary>\(v'=(1\cdot4+3\cdot0)/4=1\) m/s；\(\Delta K=2-8=-6\) J。</details>
      <details><summary><b>題 3</b></summary>\(v_1'=-5/3\approx-1.67\)、\(v_2'=10/3\approx3.33\)（m/s）。</details>
      <details><summary><b>題 4</b></summary>\(v_1'=\frac{m_1v_1+m_2v_2-m_2 e (v_1-v_2)}{m_1+m_2}\) ... 代入數值即可。</details>
      <details><summary><b>題 5</b></summary>與水平牆碰撞：\(v_x'=v_x=3\)、\(v_y'=-v_y=4\)，\(\vec v'=(3,4)\) m/s。</details>
    </div>
  </section>
</div>

<script>
const cvs = document.getElementById("simCanvas");
const ctx = cvs.getContext("2d");
cvs.width = 800; cvs.height = 220;

let state = {
  m1: 2.0, m2: 2.0, v1: 3, v2: -2,
  x1: 150, x2: 650, r1: 30, r2: 30,
  running: false, raf: null
};

function draw() {
  ctx.clearRect(0, 0, cvs.width, cvs.height);
  // 球 1 (水藍色)
  ctx.fillStyle = "#6ee7ff"; 
  ctx.beginPath(); ctx.arc(state.x1, 110, state.r1, 0, Math.PI*2); ctx.fill();
  ctx.fillStyle = "#333"; ctx.font = "bold 18px sans-serif"; ctx.fillText("m1", state.x1-12, 115);

  // 球 2 (珊瑚紅)
  ctx.fillStyle = "#f87171"; 
  ctx.beginPath(); ctx.arc(state.x2, 110, state.r2, 0, Math.PI*2); ctx.fill();
  ctx.fillStyle = "#333"; ctx.fillText("m2", state.x2-12, 115);
  
  document.getElementById("pNow").textContent = (state.m1 * state.v1 + state.m2 * state.v2).toFixed(2);
}

function simulate() {
  if (!state.running) return;
  state.x1 += state.v1; state.x2 += state.v2;

  if (Math.abs(state.x1 - state.x2) <= (state.r1 + state.r2)) {
    let v1Next = ((state.m1 - state.m2) * state.v1 + 2 * state.m2 * state.v2) / (state.m1 + state.m2);
    let v2Next = ((state.m2 - state.m1) * state.v2 + 2 * state.m1 * state.v1) / (state.m1 + state.m2);
    state.v1 = v1Next; state.v2 = v2Next;
    if (state.x1 < state.x2) { state.x1 -= 1; state.x2 += 1; } else { state.x1 += 1; state.x2 -= 1; }
  }

  if (state.x1 <= state.r1 || state.x1 >= cvs.width - state.r1) state.v1 *= -1;
  if (state.x2 <= state.r2 || state.x2 >= cvs.width - state.r2) state.v2 *= -1;

  draw();
  state.raf = requestAnimationFrame(simulate);
}

function openTab(evt, tabId) {
  document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(t => t.setAttribute('aria-selected', 'false'));
  document.getElementById(tabId).classList.add('active');
  evt.currentTarget.setAttribute('aria-selected', 'true');
}

document.getElementById("m1").oninput = (e) => {
  state.m1 = parseFloat(e.target.value);
  document.getElementById("m1v").textContent = state.m1.toFixed(1);
  draw();
};
document.getElementById("m2").oninput = (e) => {
  state.m2 = parseFloat(e.target.value);
  document.getElementById("m2v").textContent = state.m2.toFixed(1);
  draw();
};
document.getElementById("startBtn").onclick = () => {
  if (state.running) return;
  state.running = true; simulate();
};
document.getElementById("resetBtn").onclick = () => {
  state.running = false; if (state.raf) cancelAnimationFrame(state.raf);
  state.x1 = 150; state.x2 = 650; state.v1 = 3; state.v2 = -2;
  draw();
};

draw();
</script>
</body>
</html>
